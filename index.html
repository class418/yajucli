<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>野獣先輩クリックゲーム</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      background: #1e1e1e;
      color: white;
    }

    #gameContainer {
      display: flex;
      height: 100vh;
    }

    #leftPanel {
      flex: 1.2;
      background: #2a2f3a;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding-top: 30px;
      padding-bottom: 30px;
      position: relative;
    }

    #centerPanel {
      flex: 3;
      background: #1e1e1e;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    #rightPanel {
      flex: 0.8;
      background: #2a2f3a;
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    #autoClickDisplay {
      font-size: 16px;
      margin-bottom: auto;
    }

    #scoreDisplay {
      font-size: 20px;
      margin-top: auto;
      user-select: none;
    }

    #clickImage {
      cursor: pointer;
      width: 150px;
      height: 150px;
      user-select: none;
    }

    .facilityGroup {
      margin-bottom: 20px;
    }

    .facilityGroup h3 {
      margin-bottom: 10px;
    }

    .facilityButton {
      background-color: #444;
      color: white;
      border: none;
      padding: 10px;
      margin-bottom: 5px;
      width: 100%;
      text-align: left;
      cursor: pointer;
      border-radius: 5px;
      font-size: 14px;
    }

    .facilityButton.disabled {
      opacity: 0.4;
      pointer-events: none;
    }

    @media (max-width: 600px) {
      #leftPanel { flex: 1.5; }
      #centerPanel { flex: 4; }
      #rightPanel { flex: 0.5; }
    }
  </style>
</head>
<body>
  <div id="gameContainer">
    <div id="leftPanel">
      <div id="autoClickDisplay">自動クリック: 0.0/秒</div>
      <div id="scoreDisplay">ポイント: 0.0</div>
    </div>
    <div id="centerPanel">
      <img src="https://i.imgur.com/Ep6xQtr.png" id="clickImage" />
    </div>
    <div id="rightPanel">
      <div class="facilityGroup" id="buyFacilities">
        <h3>施設購入</h3>
        <!-- ボタン生成される -->
      </div>
      <div class="facilityGroup" id="upgradeFacilities">
        <h3>アップグレード</h3>
        <!-- ボタン生成される -->
      </div>
    </div>
  </div>

  <script>
    let points = 0;
    let clickPower = 1;
    let autoClickPower = 0;

    const scoreDisplay = document.getElementById("scoreDisplay");
    const autoClickDisplay = document.getElementById("autoClickDisplay");

    const clickImage = document.getElementById("clickImage");

    const facilities = [
      {
        name: "自動クリック",
        basePrice: 10,
        level: 0,
        type: "buy",
        onBuy: function () {
          this.level++;
          autoClickPower += 0.1;
        },
      },
      {
        name: "拓也さん",
        basePrice: 100,
        level: 0,
        type: "buy",
        onBuy: function () {
          this.level++;
          autoClickPower += 1;
        },
      },
      {
        name: "クリック力強化",
        basePrice: 50,
        level: 0,
        type: "upgrade",
        onBuy: function () {
          this.level++;
          clickPower += 1;
        },
      },
    ];

    function formatPoints(num) {
      if (num >= 1e9) return (num / 1e9).toFixed(1) + "B";
      if (num >= 1e6) return (num / 1e6).toFixed(1) + "M";
      if (num >= 1e3) return (num / 1e3).toFixed(1) + "K";
      return num.toFixed(1);
    }

    function updateScore() {
      scoreDisplay.textContent = `ポイント: ${formatPoints(points)}`;
      autoClickDisplay.textContent = `自動クリック: ${autoClickPower.toFixed(1)}/秒`;
      updateButtons();
    }

    clickImage.addEventListener("click", () => {
      points += clickPower;
      updateScore();
    });

    function createFacilityButtons() {
      const buyContainer = document.getElementById("buyFacilities");
      const upgradeContainer = document.getElementById("upgradeFacilities");

      facilities.forEach((f, index) => {
        const btn = document.createElement("button");
        btn.className = "facilityButton";
        btn.id = `facility-${index}`;
        btn.textContent = `${f.name} Lv.${f.level} - ${f.basePrice}pt`;

        if (f.type === "buy") {
          buyContainer.appendChild(btn);
        } else {
          upgradeContainer.appendChild(btn);
        }
      });
    }

    function updateButtons() {
      facilities.forEach((f, index) => {
        const btn = document.getElementById(`facility-${index}`);
        const price = Math.floor(f.basePrice * Math.pow(1.5, f.level));
        btn.textContent = `${f.name} Lv.${f.level} - ${formatPoints(price)}pt`;

        if (points >= price) {
          btn.classList.remove("disabled");
          btn.onclick = () => {
            if (points >= price) {
              points -= price;
              f.onBuy();
              updateScore();
            }
          };
        } else {
          btn.classList.add("disabled");
          btn.onclick = null;
        }
      });
    }

    function gameLoop() {
      points += autoClickPower / 10;
      updateScore();
    }

    createFacilityButtons();
    updateScore();
    setInterval(gameLoop, 100);
  </script>
</body>
</html>
